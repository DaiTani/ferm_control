自动化执行工具 说明文档
======================

【简介】
本工具用于自动化操作指定窗口的界面元素，支持窗口选择、区域框选、数据源选择（Excel/CSV/本地数据库）、操作逻辑编辑及自动化执行。适用于批量数据录入、自动点击、自动输入等场景。

【主要依赖】
- Python 3.7 及以上
- PyQt5
- pyautogui
- pygetwindow
- Pillow
- openpyxl
- keyboard
- opencv-python
- numpy

【安装依赖】
pip install PyQt5 pyautogui pygetwindow Pillow openpyxl keyboard opencv-python numpy

【主要功能模块】
- main_window.py         主界面入口
- settings_wizard.py     配置向导（窗口选择、区域框选、数据源、操作逻辑）
- window_selector.py     目标窗口选择
- region_selector.py     区域框选与属性设置（支持截图、类型、模板保存）
- data_source_selector.py 数据源选择（Excel/CSV/数据库）
- operation_editor.py    操作逻辑编辑（支持点击/输入/多步操作）
- execution_window.py    自动化执行与日志（支持模板匹配、数据驱动、日志输出）
- config_manager.py      配置保存与加载
- window_manager.py      窗口切换管理
- utils.py               工具函数
- pyautoguiPermalink.py  经典自动化脚本（可参考数据库批量操作逻辑）

【使用说明】
1. 运行 main_window.py 启动主界面。
2. 点击“程序设定”进入配置向导，依次完成：
   - 选择目标窗口（需已打开目标应用）
   - 框选界面元素（支持多次框选，自动截图）
   - 选择数据源（支持Excel、CSV、本地数据库）
   - 编辑操作逻辑（可设置点击/输入/多步操作）
3. 配置完成后可保存并执行自动化操作。
4. 支持执行上次操作、跳过部分步骤直接执行、测试操作逻辑等功能。
5. 执行时可查看详细日志和进度。

【数据源说明】
- Excel/CSV：自动读取表格数据，支持按列自动输入。
- 本地数据库：支持依据本地模型生成数据进行自动输入。
- 数据驱动模式下，操作逻辑可指定输入列，实现批量自动录入。

【注意事项】
- 框选区域和自动点击依赖于系统分辨率和窗口位置，请确保目标窗口未被遮挡，且分辨率/缩放比例一致。
- 若打包为可执行文件，建议统一用 utils.py 里的 resource_path 处理资源路径。
- 若遇到权限或兼容性问题，请以管理员身份运行。
- 部分功能（如模板匹配、数据库高级操作）需根据实际业务扩展。

【常见问题】
- 自动点击不准：请检查框选时保存的坐标是否为窗口内相对坐标，或检查屏幕缩放设置。
- 日志出现 QTextCursor 警告：可忽略，不影响功能。
- 数据库操作需保证表结构与脚本一致，默认表名为 data。

【联系方式】
如有问题或建议，请联系开发者。
开发者邮箱：2425476264tan@Gmail.com

【更新日志】
- 2024-06 支持本地数据库批量自动化操作，优化数据驱动逻辑。
- 2024-06 支持模板匹配点击，支持多屏坐标自适应。
- 2024-06 优化配置向导体验，支持操作逻辑测试与跳过数据源。